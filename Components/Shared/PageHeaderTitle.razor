@inject IJSRuntime jsRuntime
@inject NavigationManager Navigation

<MudPaper Elevation="2" Class="pa-2 mt-3 mb-3">
    <MudStack Row Justify="Justify.FlexStart">
        @if (ShowBackButton)
        {
            <MudIconButton Icon="@Icons.Material.Outlined.KeyboardArrowLeft" Color="Color.Primary" OnClick="NavigateBack"></MudIconButton>
        }

        <MudText Typo="Typo.h4" Color="Color.Primary">
            @if(CustomContent is null)
            {
                @Title
            }
            else
            {
                @(CustomContent)
            }
            </MudText>

        @if (ActionMenu is not null)
        {
            <MudSpacer />
            <MudIconButton Icon="@Icons.Material.Filled.MoreVert" OnClick="ShowMenu" />
        }
    </MudStack>
</MudPaper>

@code {
    [Parameter]
    public string? Title { get; set; }

    [Parameter]
    public bool ShowBackButton { get; set; } = false;

    [Parameter]
    public MudMenu? ActionMenu { get; set; } = null;

    [Parameter]
    public RenderFragment? CustomContent { get; set; }

    [Parameter]
    public string? CustomBackUrl { get; set; } = null;

    [Parameter]
    public string? Href { get; set; } = null;

    public async Task NavigateBack()
    {
        if (CustomBackUrl is null)
        {
            await jsRuntime.InvokeVoidAsync("history.back");
        }
        else
        {
            Navigation.NavigateTo(CustomBackUrl, true);
        }
    }

    private async Task ShowMenu(MouseEventArgs args)
    {
        if (ActionMenu is not null)
        {
            await ActionMenu.OpenMenuAsync(args);
        }
    }
}
